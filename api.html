<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JackAndOreo</title>
    <meta property="og:title" content="Jackandoreo.github.io">
    <meta property="og:type" content="website">
    <meta property="og:image" content="縮圖檔">
    <meta property="og:url" content="網頁路徑">
    <meta property="og:site_name" content="網頁名稱">
    <meta property="og:description" content="網頁介紹">
    <meta property="og:locale" content="zh_TW">
    <link rel="stylesheet" href="./css/indexPlug.min.css">
    <link rel="stylesheet" href="./css/spin.min.css">
    <link rel="stylesheet" href="./css/api.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="/js/jquery-3.7.1.min.js"></script>
</head>

<body>
    <div id="api_body" class="df_jc_ac">
        <div class="api_container">
            <div class="api_intro">
                展示如何根據條件利用API內的資料，將其放入對應位置。
            </div>
            <div class="photo_container photo_container_1">
                <div class="container_title">長寬比3:2</div>
                <div class="container_box wider_pic"></div>
            </div>
            <div class="photo_container photo_container_2">
                <div class="container_title">長寬比2:3</div>
                <div class="container_box length_pic"></div>
            </div>
            <div class="photo_container photo_container_1">
                <div class="container_title">皆不符合</div>
                <div class="container_box other_pic"></div>
            </div>
        </div>
    </div>
    <script src="/js/fontControl.js"></script>
    <script src="/js/deviceDetect.js"></script>
    <script>
        const url = "https://api.unsplash.com/photos/?client_id=xivQH_C7HTYo27YAIKhGghkr3CCMF7WNtGw7PqXPIvs";

        function getData() {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    const apiBox = $('.api_container');
                    const container1 = apiBox.find('.wider_pic');
                    const container2 = apiBox.find('.length_pic');
                    const container3 = apiBox.find('.other_pic');

                    const isApproxRatio = (width, height, ratio) => {
                        const errorMargin = 0.04;
                        const actualRatio = width / height;
                        return Math.abs(actualRatio - ratio) / ratio < errorMargin;
                    };

                    data.forEach(item => {
                        const img = $('<img>', {
                            src: item.urls.regular,
                            alt: item.alt_description,
                            title: item.alt_description
                        });

                        if (isApproxRatio(item.width, item.height, 3 / 2)) {
                            container1.append(img);
                        } else if (isApproxRatio(item.width, item.height, 2 / 3)) {
                            container2.append(img);
                        } else {
                            container3.append(img);
                        }
                    });
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        getData();
    </script>
</body>

</html>